{
  "hash": "4d8afdc2340863e6e211e71046e20a2b",
  "result": {
    "markdown": "---\ntitle: \"Bank Data\"\nformat: html\n---\n\n\nUS banks are required to report quarterly financial data e.g., Balance Sheet and Income Statements, to the US Federal Financial Institutions Examination Council (FFIEC) who make this data publicly available in a consolidated format as a part of their Uniform Bank Performance Reporting (UBPR) regime. Data is available from 2002 Q4 @ffiec.\n\nWe are interested in measures that will provide insights to Bank's credit card businesses as shown in @tbl-ccmeasures. \n\n\n::: {#tbl-ccmeasures .cell tbl-cap='UBPR Credit Card Measures'}\n\n```{.r .cell-code}\nsource('functions.R')\n\ncredit_card() |> \n    distinct(Measure, Description) |> \n    filter(str_detect(Description, \"Credit|90 days\")) |> \n    knitr::kable(format = \"html\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Measure </th>\n   <th style=\"text-align:left;\"> Description </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> UBPR3815 </td>\n   <td style=\"text-align:left;\"> Unused Commitments on Credit Cards </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> UBPRB538 </td>\n   <td style=\"text-align:left;\"> Loans to Individuals for Household, Family, and Other Personal Expenditures (I.E., Consumer Loans)(Includes Purchased Paper):Credit Cards </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> UBPRE263 </td>\n   <td style=\"text-align:left;\"> Unused Commitments on Credit Cards as a percent of Total Assets </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> UBPRE425 </td>\n   <td style=\"text-align:left;\"> Credit Card Loans, % Gross LN&amp;LS </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> UBPRE889 </td>\n   <td style=\"text-align:left;\"> Credit Card Loans, % Tier 1 Capital plus Allowance </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> UBPRE521 </td>\n   <td style=\"text-align:left;\"> Credit Card Plans-90+ Days P/D % </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> UBPRE522 </td>\n   <td style=\"text-align:left;\"> Credit Card Plans-Nonaccrual % </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> UBPRE523 </td>\n   <td style=\"text-align:left;\"> 90 days+ Nonaccrual (UBPRE521+UBPRE522) </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> UBPRE524 </td>\n   <td style=\"text-align:left;\"> Credit Card Plans-30-89 DAYS P/D % </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> UBPRE411 </td>\n   <td style=\"text-align:left;\"> Credit Card Plans Net Losses (%) </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n## Measure of portfolio quality\n\nTo measure quality we can use the proportion of credit cards that are delinquent in the portfolio. This is the sum of UBPRE523 and UBPRE524; accounts that are accruing payments but are overdue by 30 day+ or are in non-accrual status i.e. non-performing loans. \n\nHowever, given we are interested in the impact of a partnership, using measure **Credit Card Plans-30-89 DAYS P/D %** (UBPRE524) is ideal as it gives us the earliest indicator of delinquency.\n\n## Bank Peer Groups\n\nThe scope of Banks included in our analysis is not limited to the banks involved in credit card partnerships. We can use data from FFIEC to add information about their peers i.e. other banks that are similar. \n\n@tbl-peergrpcnt details 3 peer groups. National (US-wide) Credit card partnerships occur between banks in the **Large Bank** and **Large Credit Card Bank** groups. These peer groups are defined by FFIEC (see @sec-peers for full list of Banks in each peer group) [@ffiec].\n\nA Large Bank like CITIBANK will have a multiple businesses: household mortgages and credit cards; market trading; investment banking and more. In contrast, large credit card banks like BARCLAYS US specialise in credit cards only. Consequently, we expect to see the peer groups react differently to external factors, or exhibit different internal dynamics and risk profiles. \n\n\n::: {#tbl-peergrpcnt .cell tbl-cap='Number of Banks in each peer group'}\n\n```{.r .cell-code}\noverdue30to89 <- credit_card.overdue_3089()\ntarget_label <- credit_card.target_label()\n\nbank_scope <- overdue30to89 |> \n                as_tibble() |> \n                group_by(BankName,BankType) |> \n                summarise(total_bal = sum(abs(Value),na.rm=T)) |>\n                filter(!(is.na(total_bal)|total_bal==0))\n\nbank_n <- bank_scope |>\n            group_by(BankType) |> \n            summarise(Number = n())\n\nbank_n |> right_join(bank_type.desc()) |> \n            relocate(Number, .after = last_col()) |>  \n            knitr::kable(format = \"html\")    \n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> BankType </th>\n   <th style=\"text-align:left;\"> PeerId </th>\n   <th style=\"text-align:left;\"> Criteria </th>\n   <th style=\"text-align:left;\"> Examples </th>\n   <th style=\"text-align:right;\"> Number </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> LargeBank </td>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:left;\"> Insured commercial banks having assets greater than $100 billion </td>\n   <td style=\"text-align:left;\"> CITIBANK, JPMORGAN CHASE BANK, MORGAN STANLEY </td>\n   <td style=\"text-align:right;\"> 22 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> LargeCreditCardBank </td>\n   <td style=\"text-align:left;\"> 201 </td>\n   <td style=\"text-align:left;\"> Large Credit Card Banks: Credit card specialty banks having assets greater than $ 3 billion </td>\n   <td style=\"text-align:left;\"> BARCLAYS BANK, SYNCHRONY BANK, DISCOVER BANK </td>\n   <td style=\"text-align:right;\"> 7 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> OtherBank </td>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:left;\"> Other - all other Banks that have reported UBPRE524 </td>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:right;\"> 1257 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n::: {.callout-note}\nWhy are there thousands of Banks? The US Banking system grew out of 19th-century regulations that restricted where banks could operate. This resulted in a very localised Banking market. Today big banks such as JPMorgan Chase, Bank of America, Citigroup and Wells Fargo, dominate the industry but there are still about 4,100 US Banks compared with 353 in Britain and 261 in Germany [@economist2023]. \n:::\n\n## Data Period\n\nRegulation implemented in 2010 had a material impact on the credit card market [@cfpb2013; also @boston2014]. As highlighted by @boston2014, regulation coincided with the 2008 financial crisis and recession, making it difficult to fully assert causation [-@boston2014].\n\nThe regulations introduced were:\n\n1. Credit Card Accountability Responsibility and Disclosure (CARD) Act of 2009 which had a staggered implementation in February and August 2010. This Act requires Banks to assess whether a potential borrower has the means to repay. Additionally, high-risk borrowers like those under 21, have additional restrictions. This has led to stricter lending criteria e.g., income and credit history checks [@cfpb2013]. \n2. Regulation Z, or the Truth in Lending Act (TILA), focuses on ensuring transparency and fairness in lending practices. Banks have to provide full disclosure of the terms and conditions of a loan agreement [@cfpb2010z].\n\nWe can see the impact in @fig-regulation which plots a linear trend for *Credit Card Plans-30-89 DAYS P/D %* for each peer group. Based on @fig-regulation-3 there was increasing delinquency for Large Banks and Large Credit Card Banks before regulation, but post regulation the trend has reversed and is now trending down.\n\nFor our analysis we will focus on credit card partnerships post regulation as this is more relevant for commenting on future partnership deals. \n\n\n::: {#fig-regulation .cell layout-ncol=\"1\"}\n\n```{.r .cell-code}\nreg_date_z <- as.Date(\"2010-07-01\")\nreg_date_c1 <- as.Date(\"2010-02-22\")\nreg_date_c2 <- as.Date(\"2010-08-22\")\n\noverdue30to89 |> \n    filter(value_diff <= 23) |>\n    group_by(BankType) |>\n        summarise(val_mean = mean(Value, na.rm=T)) |> \n        autoplot(val_mean, aes(colour=BankType)) +\n        geom_smooth(method = \"lm\", se = FALSE, show.legend = F, linewidth=.5) +    \n        scale_color_manual(values = bank_type.colours())+\n        theme(legend.position = \"top\",\n                legend.title=element_blank()) +\n        labs(y=glue(\"{target_label} \\n mean\"), x=\"\")\n\noverdue30to89 |> \n    filter(value_diff <= 23) |>\n    group_by(BankType) |> summarise(variance = var(Value)) |> \n    autoplot(variance) +\n    geom_vline(xintercept = reg_date_c1,linetype=2,colour=\"red\") +\n    annotate(\"label\",label=\"i\", x=reg_date_c1, y=20.0) +\n    geom_vline(xintercept = reg_date_z,linetype=2,colour=\"red\") +\n    annotate(\"label\",label=\"ii\", x=reg_date_z, y=18.0) +\n    geom_vline(xintercept = reg_date_c2,linetype=2,colour=\"red\") +\n    annotate(\"label\",label=\"iii\", x=reg_date_c2, y=16.0) +\n    labs(y=glue(\"{target_label} \\n variance\"), x=\"\") +\n    scale_color_manual(values = bank_type.colours())+\n    theme(legend.position = \"top\", legend.title=element_blank()) \n\n\noverdue30to89 |> \n    filter(value_diff <= 23) |>\n    mutate(regulation = ifelse(as.Date(Quarter) < reg_date_c1, 'Before', 'After')) |> \n        group_by(BankType, regulation) |>\n        summarise(val_mean = mean(Value, na.rm=T)) |> \n        autoplot(val_mean, aes(colour=BankType)) +\n        geom_smooth(method = \"lm\", se = FALSE, show.legend = F,linewidth=.5) +    \n        scale_color_manual(values = bank_type.colours(), breaks=c(\"LargeBank\",\"LargeCreditCardBank\",\"OtherBank\"))+\n        geom_vline(xintercept = reg_date_c1,linetype=2,colour=\"red\")+\n        annotate(\"label\",label=\"CARD Act Part 1 comes into effect\", x=reg_date_c1, y=3.5, hjust = - 0.05) +\n        labs(y=glue(\"{target_label} \\n mean\"), x=\"\") +\n        theme(legend.position = \"top\", legend.title=element_blank())\n```\n\n::: {.cell-output-display}\n![Bank Type have different intercepts and data patterns](data_ffiec_files/figure-html/fig-regulation-1.png){#fig-regulation-1 width=672}\n:::\n\n::: {.cell-output-display}\n![Variance pre and post Regulation <br>(i) - CARD Act part 1 (ii) - Regulation Z and (iii) Card Act part 2 <br>The variance for Large Banks and Large Credit Card Banks have reduced post regulatory changes.](data_ffiec_files/figure-html/fig-regulation-2.png){#fig-regulation-2 width=672}\n:::\n\n::: {.cell-output-display}\n![Linear trend pre and post Regulation.](data_ffiec_files/figure-html/fig-regulation-3.png){#fig-regulation-3 width=672}\n:::\n\nImpact of Regulation\n:::\n\n## Bank Outliers {#sec-outliers}\n\nAs we are dealing with time series data, we need to identify banks where their individual series characteristics are markedly different from those of its peers.\n\nTaking the approach from @Hyndman2021 we can use Principal Components Analysis (PCA) to review outliers across different statistical features or feature sets. \n\n::: {#tbl-outliers .panel-tabset} \n\n\n::: {.cell}\n\n```{.r .cell-code}\nregulation_cutoff <-get_regulation_cutoff()\n\noverdue30to89_post <- overdue30to89 |>\n                    filter_index(regulation_cutoff ~ .) \n\noverdue30to89_lbanks <- overdue30to89_post |>\n                         filter(BankType %in% c(\"LargeBank\", \"LargeCreditCardBank\"))\n```\n:::\n\n\n## Lumpiness and Stability\n\n::: {#fig-out-lump .cell layout-ncol=\"1\"}\n\n```{.r .cell-code}\npca_output <- feature_data(overdue30to89_lbanks, c(\"lumpiness\",\"stability\")) |> feature_prcomp()\n\npcs.plot(pca_output)\noutlier.plot(overdue30to89_lbanks, pca_output, -2, 2, -3, 3)\n```\n\n::: {.cell-output-display}\n![PCA for <span style='color:#1B9E77'>Large</span> and <span style='color:#D95F02'>Large Credit Card</span> Banks using features: lumpiness and stability](data_ffiec_files/figure-html/fig-out-lump-1.png){#fig-out-lump-1 width=672}\n:::\n\n::: {.cell-output-display}\n![Data series for Outlier Banks](data_ffiec_files/figure-html/fig-out-lump-2.png){#fig-out-lump-2 width=672}\n:::\n\nOutlier Detection using PCA\n:::\n\n\n## Seasonal\n\n::: {#fig-out-season .cell layout-ncol=\"1\"}\n\n```{.r .cell-code}\npca_output <- feature_data(overdue30to89_lbanks, \"seasonal\") |> feature_prcomp()\n\npcs.plot(pca_output)\noutlier.plot(overdue30to89_lbanks, pca_output, -4, 4, -3, 3)\n```\n\n::: {.cell-output-display}\n![PCA for <span style='color:#1B9E77'>Large</span> and <span style='color:#D95F02'>Large Credit Card</span> Banks using features: seasonal](data_ffiec_files/figure-html/fig-out-season-1.png){#fig-out-season-1 width=672}\n:::\n\n::: {.cell-output-display}\n![Data series for Outlier Banks](data_ffiec_files/figure-html/fig-out-season-2.png){#fig-out-season-2 width=672}\n:::\n\nOutlier Detection using PCA\n:::\n\n## ACF\n\n::: {#fig-out-acf .cell layout-ncol=\"1\"}\n\n```{.r .cell-code}\npca_output <- feature_data(overdue30to89_lbanks, \"acf\") |> feature_prcomp()\n\npcs.plot(pca_output)\noutlier.plot(overdue30to89_lbanks, pca_output, -3, 3, -3, 3)\n```\n\n::: {.cell-output-display}\n![PCA for <span style='color:#1B9E77'>Large</span> and <span style='color:#D95F02'>Large Credit Card</span> Banks using features: acf](data_ffiec_files/figure-html/fig-out-acf-1.png){#fig-out-acf-1 width=672}\n:::\n\n::: {.cell-output-display}\n![Data series for Outlier Banks](data_ffiec_files/figure-html/fig-out-acf-2.png){#fig-out-acf-2 width=672}\n:::\n\nOutlier Detection using PCA\n:::\n\n## PACF\n\n::: {#fig-out-pacf .cell layout-ncol=\"1\"}\n\n```{.r .cell-code}\npca_output <- feature_data(overdue30to89_lbanks, \"pacf\") |> feature_prcomp()\n\npcs.plot(pca_output)\noutlier.plot(overdue30to89_lbanks, pca_output, -3, 3, -2, 2)\n```\n\n::: {.cell-output-display}\n![PCA for <span style='color:#1B9E77'>Large</span> and <span style='color:#D95F02'>Large Credit Card</span> Banks using features: pacf](data_ffiec_files/figure-html/fig-out-pacf-1.png){#fig-out-pacf-1 width=672}\n:::\n\n::: {.cell-output-display}\n![Data series for Outlier Banks](data_ffiec_files/figure-html/fig-out-pacf-2.png){#fig-out-pacf-2 width=672}\n:::\n\nOutlier Detection using PCA\n:::\n\n## Data\n\n::: {.cell}\n\n```{.r .cell-code}\nselected_feats <- c(\"lumpiness\",\"stability\",\"seasonal\", \"pacf\", \"acf\")\n\nfeature_data(overdue30to89_lbanks,selected_feats) |>\n    select(-c(IDRSSD,Measure,Label,Description,BankType)) |> \n        knitr::kable(format = \"html\")    \n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> BankName </th>\n   <th style=\"text-align:right;\"> trend_strength </th>\n   <th style=\"text-align:right;\"> seasonal_strength_year </th>\n   <th style=\"text-align:right;\"> seasonal_peak_year </th>\n   <th style=\"text-align:right;\"> seasonal_trough_year </th>\n   <th style=\"text-align:right;\"> spikiness </th>\n   <th style=\"text-align:right;\"> linearity </th>\n   <th style=\"text-align:right;\"> curvature </th>\n   <th style=\"text-align:right;\"> stl_e_acf1 </th>\n   <th style=\"text-align:right;\"> stl_e_acf10 </th>\n   <th style=\"text-align:right;\"> acf1 </th>\n   <th style=\"text-align:right;\"> acf10 </th>\n   <th style=\"text-align:right;\"> diff1_acf1 </th>\n   <th style=\"text-align:right;\"> diff1_acf10 </th>\n   <th style=\"text-align:right;\"> diff2_acf1 </th>\n   <th style=\"text-align:right;\"> diff2_acf10 </th>\n   <th style=\"text-align:right;\"> season_acf1 </th>\n   <th style=\"text-align:right;\"> pacf5 </th>\n   <th style=\"text-align:right;\"> diff1_pacf5 </th>\n   <th style=\"text-align:right;\"> diff2_pacf5 </th>\n   <th style=\"text-align:right;\"> season_pacf </th>\n   <th style=\"text-align:right;\"> nsdiffs </th>\n   <th style=\"text-align:right;\"> var_tiled_var </th>\n   <th style=\"text-align:right;\"> var_tiled_mean </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> HUNTINGTON NATIONAL BANK, THE (12311) </td>\n   <td style=\"text-align:right;\"> 0.9594001 </td>\n   <td style=\"text-align:right;\"> 0.1851927 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 1.0e-07 </td>\n   <td style=\"text-align:right;\"> 0.9790451 </td>\n   <td style=\"text-align:right;\"> -2.3058692 </td>\n   <td style=\"text-align:right;\"> -0.2384169 </td>\n   <td style=\"text-align:right;\"> 0.3686124 </td>\n   <td style=\"text-align:right;\"> 0.8704864 </td>\n   <td style=\"text-align:right;\"> 2.1518687 </td>\n   <td style=\"text-align:right;\"> 0.0065967 </td>\n   <td style=\"text-align:right;\"> 0.1025091 </td>\n   <td style=\"text-align:right;\"> -0.4398537 </td>\n   <td style=\"text-align:right;\"> 0.4416172 </td>\n   <td style=\"text-align:right;\"> 0.4729891 </td>\n   <td style=\"text-align:right;\"> 0.8102590 </td>\n   <td style=\"text-align:right;\"> 0.0718444 </td>\n   <td style=\"text-align:right;\"> 0.5569388 </td>\n   <td style=\"text-align:right;\"> -0.2116832 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0.0526931 </td>\n   <td style=\"text-align:right;\"> 0.9172632 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> DISCOVER BANK (30810) </td>\n   <td style=\"text-align:right;\"> 0.9922735 </td>\n   <td style=\"text-align:right;\"> 0.8066175 </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 0.0e+00 </td>\n   <td style=\"text-align:right;\"> -0.1659662 </td>\n   <td style=\"text-align:right;\"> 1.2013034 </td>\n   <td style=\"text-align:right;\"> -0.0908068 </td>\n   <td style=\"text-align:right;\"> 0.1137021 </td>\n   <td style=\"text-align:right;\"> 0.7862848 </td>\n   <td style=\"text-align:right;\"> 1.1637763 </td>\n   <td style=\"text-align:right;\"> 0.3952864 </td>\n   <td style=\"text-align:right;\"> 0.6535449 </td>\n   <td style=\"text-align:right;\"> -0.1960388 </td>\n   <td style=\"text-align:right;\"> 1.4154840 </td>\n   <td style=\"text-align:right;\"> 0.2053920 </td>\n   <td style=\"text-align:right;\"> 0.6648070 </td>\n   <td style=\"text-align:right;\"> 0.4705571 </td>\n   <td style=\"text-align:right;\"> 0.6722316 </td>\n   <td style=\"text-align:right;\"> -0.0339051 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 0.0602937 </td>\n   <td style=\"text-align:right;\"> 1.0211713 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> BMO HARRIS BANK NATIONAL ASSOCIATION (75633) </td>\n   <td style=\"text-align:right;\"> 0.9731587 </td>\n   <td style=\"text-align:right;\"> 0.1931983 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 1.8e-06 </td>\n   <td style=\"text-align:right;\"> -4.9215658 </td>\n   <td style=\"text-align:right;\"> 3.5142603 </td>\n   <td style=\"text-align:right;\"> 0.0028593 </td>\n   <td style=\"text-align:right;\"> 0.2300472 </td>\n   <td style=\"text-align:right;\"> 0.8551877 </td>\n   <td style=\"text-align:right;\"> 1.7052974 </td>\n   <td style=\"text-align:right;\"> 0.1713459 </td>\n   <td style=\"text-align:right;\"> 0.0561221 </td>\n   <td style=\"text-align:right;\"> -0.3385544 </td>\n   <td style=\"text-align:right;\"> 0.2133678 </td>\n   <td style=\"text-align:right;\"> 0.3636093 </td>\n   <td style=\"text-align:right;\"> 0.8924736 </td>\n   <td style=\"text-align:right;\"> 0.0544716 </td>\n   <td style=\"text-align:right;\"> 0.3864109 </td>\n   <td style=\"text-align:right;\"> -0.3584475 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0.2353694 </td>\n   <td style=\"text-align:right;\"> 0.8825032 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> CAPITAL ONE, NATIONAL ASSOCIATION (112837) </td>\n   <td style=\"text-align:right;\"> 0.9013988 </td>\n   <td style=\"text-align:right;\"> 0.5171827 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 1.0e-07 </td>\n   <td style=\"text-align:right;\"> 0.2854529 </td>\n   <td style=\"text-align:right;\"> 0.3567008 </td>\n   <td style=\"text-align:right;\"> -0.0335341 </td>\n   <td style=\"text-align:right;\"> 0.3997976 </td>\n   <td style=\"text-align:right;\"> 0.6899219 </td>\n   <td style=\"text-align:right;\"> 0.9380740 </td>\n   <td style=\"text-align:right;\"> 0.0784484 </td>\n   <td style=\"text-align:right;\"> 0.2688924 </td>\n   <td style=\"text-align:right;\"> -0.2857481 </td>\n   <td style=\"text-align:right;\"> 0.3612018 </td>\n   <td style=\"text-align:right;\"> 0.1748990 </td>\n   <td style=\"text-align:right;\"> 0.6469421 </td>\n   <td style=\"text-align:right;\"> 0.1884833 </td>\n   <td style=\"text-align:right;\"> 0.4699335 </td>\n   <td style=\"text-align:right;\"> -0.1231420 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0.2516133 </td>\n   <td style=\"text-align:right;\"> 0.7110751 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> REGIONS BANK (233031) </td>\n   <td style=\"text-align:right;\"> 0.8508971 </td>\n   <td style=\"text-align:right;\"> 0.4118063 </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 6.0e-07 </td>\n   <td style=\"text-align:right;\"> 0.4874497 </td>\n   <td style=\"text-align:right;\"> -0.7087346 </td>\n   <td style=\"text-align:right;\"> -0.4005925 </td>\n   <td style=\"text-align:right;\"> 0.3434169 </td>\n   <td style=\"text-align:right;\"> 0.4711020 </td>\n   <td style=\"text-align:right;\"> 0.3315850 </td>\n   <td style=\"text-align:right;\"> -0.1032090 </td>\n   <td style=\"text-align:right;\"> 0.1956841 </td>\n   <td style=\"text-align:right;\"> -0.4493796 </td>\n   <td style=\"text-align:right;\"> 0.3890206 </td>\n   <td style=\"text-align:right;\"> -0.0079497 </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 3.6352104 </td>\n   <td style=\"text-align:right;\"> 0.4720881 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> KEYBANK NATIONAL ASSOCIATION (280110) </td>\n   <td style=\"text-align:right;\"> 0.9309869 </td>\n   <td style=\"text-align:right;\"> 0.4931755 </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 3.0e-07 </td>\n   <td style=\"text-align:right;\"> -1.8234225 </td>\n   <td style=\"text-align:right;\"> 0.5183980 </td>\n   <td style=\"text-align:right;\"> -0.4305042 </td>\n   <td style=\"text-align:right;\"> 0.3447049 </td>\n   <td style=\"text-align:right;\"> 0.8135461 </td>\n   <td style=\"text-align:right;\"> 2.4775455 </td>\n   <td style=\"text-align:right;\"> -0.2746275 </td>\n   <td style=\"text-align:right;\"> 0.3145507 </td>\n   <td style=\"text-align:right;\"> -0.5149800 </td>\n   <td style=\"text-align:right;\"> 0.3717557 </td>\n   <td style=\"text-align:right;\"> 0.6186054 </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0.0963274 </td>\n   <td style=\"text-align:right;\"> 0.8988192 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> HSBC BANK USA, NATIONAL ASSOCIATION (413208) </td>\n   <td style=\"text-align:right;\"> 0.8892880 </td>\n   <td style=\"text-align:right;\"> 0.4446685 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 2.0e-07 </td>\n   <td style=\"text-align:right;\"> -1.5184815 </td>\n   <td style=\"text-align:right;\"> 0.5641250 </td>\n   <td style=\"text-align:right;\"> -0.3526981 </td>\n   <td style=\"text-align:right;\"> 0.2545830 </td>\n   <td style=\"text-align:right;\"> 0.6588533 </td>\n   <td style=\"text-align:right;\"> 1.0367453 </td>\n   <td style=\"text-align:right;\"> -0.2240143 </td>\n   <td style=\"text-align:right;\"> 0.3439734 </td>\n   <td style=\"text-align:right;\"> -0.4532848 </td>\n   <td style=\"text-align:right;\"> 0.3509279 </td>\n   <td style=\"text-align:right;\"> 0.4018872 </td>\n   <td style=\"text-align:right;\"> 0.5154671 </td>\n   <td style=\"text-align:right;\"> 0.2663376 </td>\n   <td style=\"text-align:right;\"> 0.6708638 </td>\n   <td style=\"text-align:right;\"> 0.1205320 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0.0962158 </td>\n   <td style=\"text-align:right;\"> 0.9124017 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> WELLS FARGO BANK, NATIONAL ASSOCIATION (451965) </td>\n   <td style=\"text-align:right;\"> 0.9897585 </td>\n   <td style=\"text-align:right;\"> 0.7286094 </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0.0e+00 </td>\n   <td style=\"text-align:right;\"> -2.2131264 </td>\n   <td style=\"text-align:right;\"> 1.1115184 </td>\n   <td style=\"text-align:right;\"> -0.2202096 </td>\n   <td style=\"text-align:right;\"> 0.3214417 </td>\n   <td style=\"text-align:right;\"> 0.8177539 </td>\n   <td style=\"text-align:right;\"> 1.7798598 </td>\n   <td style=\"text-align:right;\"> 0.1963038 </td>\n   <td style=\"text-align:right;\"> 0.8245209 </td>\n   <td style=\"text-align:right;\"> -0.1691286 </td>\n   <td style=\"text-align:right;\"> 1.4047897 </td>\n   <td style=\"text-align:right;\"> 0.4529391 </td>\n   <td style=\"text-align:right;\"> 0.7302056 </td>\n   <td style=\"text-align:right;\"> 0.4258005 </td>\n   <td style=\"text-align:right;\"> 0.8406284 </td>\n   <td style=\"text-align:right;\"> 0.0019227 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 0.0409414 </td>\n   <td style=\"text-align:right;\"> 0.9193642 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> CITIBANK, N.A. (476810) </td>\n   <td style=\"text-align:right;\"> 0.9905407 </td>\n   <td style=\"text-align:right;\"> 0.2507006 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 0.0e+00 </td>\n   <td style=\"text-align:right;\"> -3.5123145 </td>\n   <td style=\"text-align:right;\"> 2.0410946 </td>\n   <td style=\"text-align:right;\"> -0.3013451 </td>\n   <td style=\"text-align:right;\"> 0.4440395 </td>\n   <td style=\"text-align:right;\"> 0.8872498 </td>\n   <td style=\"text-align:right;\"> 2.5634145 </td>\n   <td style=\"text-align:right;\"> 0.0330712 </td>\n   <td style=\"text-align:right;\"> 0.1705545 </td>\n   <td style=\"text-align:right;\"> -0.5129104 </td>\n   <td style=\"text-align:right;\"> 0.4652219 </td>\n   <td style=\"text-align:right;\"> 0.5437436 </td>\n   <td style=\"text-align:right;\"> 0.8595121 </td>\n   <td style=\"text-align:right;\"> 0.1546993 </td>\n   <td style=\"text-align:right;\"> 0.6528015 </td>\n   <td style=\"text-align:right;\"> -0.2252334 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0.0202216 </td>\n   <td style=\"text-align:right;\"> 0.9684847 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> BANK OF AMERICA, NATIONAL ASSOCIATION (480228) </td>\n   <td style=\"text-align:right;\"> 0.9758815 </td>\n   <td style=\"text-align:right;\"> 0.3244062 </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1.0e-07 </td>\n   <td style=\"text-align:right;\"> 2.3264374 </td>\n   <td style=\"text-align:right;\"> -1.1930309 </td>\n   <td style=\"text-align:right;\"> -0.1979325 </td>\n   <td style=\"text-align:right;\"> 0.2095904 </td>\n   <td style=\"text-align:right;\"> 0.9180160 </td>\n   <td style=\"text-align:right;\"> 4.2053073 </td>\n   <td style=\"text-align:right;\"> -0.0137156 </td>\n   <td style=\"text-align:right;\"> 0.0819708 </td>\n   <td style=\"text-align:right;\"> -0.4288366 </td>\n   <td style=\"text-align:right;\"> 0.2644158 </td>\n   <td style=\"text-align:right;\"> 0.7103004 </td>\n   <td style=\"text-align:right;\"> 0.8554632 </td>\n   <td style=\"text-align:right;\"> 0.0346059 </td>\n   <td style=\"text-align:right;\"> 0.5024114 </td>\n   <td style=\"text-align:right;\"> -0.0510390 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0.1676933 </td>\n   <td style=\"text-align:right;\"> 0.9428022 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> FIRST-CITIZENS BANK &amp; TRUST COMPANY (491224) </td>\n   <td style=\"text-align:right;\"> 0.8421675 </td>\n   <td style=\"text-align:right;\"> 0.4167009 </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1.0e-07 </td>\n   <td style=\"text-align:right;\"> -0.3226864 </td>\n   <td style=\"text-align:right;\"> 0.4208274 </td>\n   <td style=\"text-align:right;\"> -0.5530143 </td>\n   <td style=\"text-align:right;\"> 0.3823607 </td>\n   <td style=\"text-align:right;\"> 0.5906994 </td>\n   <td style=\"text-align:right;\"> 1.0804044 </td>\n   <td style=\"text-align:right;\"> -0.5501613 </td>\n   <td style=\"text-align:right;\"> 0.5295010 </td>\n   <td style=\"text-align:right;\"> -0.7074632 </td>\n   <td style=\"text-align:right;\"> 0.8315735 </td>\n   <td style=\"text-align:right;\"> 0.3316097 </td>\n   <td style=\"text-align:right;\"> 0.4900145 </td>\n   <td style=\"text-align:right;\"> 0.3449159 </td>\n   <td style=\"text-align:right;\"> 0.7305240 </td>\n   <td style=\"text-align:right;\"> -0.0424903 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0.1309883 </td>\n   <td style=\"text-align:right;\"> 0.8088260 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> TD BANK, N.A. (497404) </td>\n   <td style=\"text-align:right;\"> 0.7662148 </td>\n   <td style=\"text-align:right;\"> 0.2251724 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 2.7e-06 </td>\n   <td style=\"text-align:right;\"> -0.9766554 </td>\n   <td style=\"text-align:right;\"> -0.0300785 </td>\n   <td style=\"text-align:right;\"> -0.4469009 </td>\n   <td style=\"text-align:right;\"> 0.2821193 </td>\n   <td style=\"text-align:right;\"> 0.5249505 </td>\n   <td style=\"text-align:right;\"> 0.8671923 </td>\n   <td style=\"text-align:right;\"> -0.4233547 </td>\n   <td style=\"text-align:right;\"> 0.2067872 </td>\n   <td style=\"text-align:right;\"> -0.6461538 </td>\n   <td style=\"text-align:right;\"> 0.4567001 </td>\n   <td style=\"text-align:right;\"> 0.3604922 </td>\n   <td style=\"text-align:right;\"> 0.3809155 </td>\n   <td style=\"text-align:right;\"> 0.2332575 </td>\n   <td style=\"text-align:right;\"> 0.9562263 </td>\n   <td style=\"text-align:right;\"> 0.0292517 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 1.4784725 </td>\n   <td style=\"text-align:right;\"> 0.6331331 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> MANUFACTURERS AND TRADERS TRUST COMPANY (501105) </td>\n   <td style=\"text-align:right;\"> 0.9623463 </td>\n   <td style=\"text-align:right;\"> 0.3594356 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1.0e-07 </td>\n   <td style=\"text-align:right;\"> 1.6551464 </td>\n   <td style=\"text-align:right;\"> -1.8119568 </td>\n   <td style=\"text-align:right;\"> -0.3615094 </td>\n   <td style=\"text-align:right;\"> 0.2970056 </td>\n   <td style=\"text-align:right;\"> 0.8601116 </td>\n   <td style=\"text-align:right;\"> 2.3650586 </td>\n   <td style=\"text-align:right;\"> -0.1906941 </td>\n   <td style=\"text-align:right;\"> 0.2349664 </td>\n   <td style=\"text-align:right;\"> -0.5192534 </td>\n   <td style=\"text-align:right;\"> 0.3886177 </td>\n   <td style=\"text-align:right;\"> 0.5677673 </td>\n   <td style=\"text-align:right;\"> 0.7806492 </td>\n   <td style=\"text-align:right;\"> 0.2107491 </td>\n   <td style=\"text-align:right;\"> 0.8724141 </td>\n   <td style=\"text-align:right;\"> -0.0470332 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0.0120100 </td>\n   <td style=\"text-align:right;\"> 0.9457211 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> U.S. BANK NATIONAL ASSOCIATION (504713) </td>\n   <td style=\"text-align:right;\"> 0.9779492 </td>\n   <td style=\"text-align:right;\"> 0.7111517 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 0.0e+00 </td>\n   <td style=\"text-align:right;\"> -1.0735068 </td>\n   <td style=\"text-align:right;\"> 0.1084410 </td>\n   <td style=\"text-align:right;\"> -0.2178394 </td>\n   <td style=\"text-align:right;\"> 0.4161126 </td>\n   <td style=\"text-align:right;\"> 0.8122313 </td>\n   <td style=\"text-align:right;\"> 1.6941760 </td>\n   <td style=\"text-align:right;\"> 0.0548283 </td>\n   <td style=\"text-align:right;\"> 0.6364354 </td>\n   <td style=\"text-align:right;\"> -0.3174083 </td>\n   <td style=\"text-align:right;\"> 0.8644822 </td>\n   <td style=\"text-align:right;\"> 0.4680712 </td>\n   <td style=\"text-align:right;\"> 0.7816474 </td>\n   <td style=\"text-align:right;\"> 0.2606029 </td>\n   <td style=\"text-align:right;\"> 0.7150975 </td>\n   <td style=\"text-align:right;\"> -0.0053972 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 0.0498886 </td>\n   <td style=\"text-align:right;\"> 0.8748621 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> SANTANDER BANK, NATIONAL ASSOCIATION (722777) </td>\n   <td style=\"text-align:right;\"> 0.8529291 </td>\n   <td style=\"text-align:right;\"> 0.0711130 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 2.7e-06 </td>\n   <td style=\"text-align:right;\"> 0.2149455 </td>\n   <td style=\"text-align:right;\"> 0.0201025 </td>\n   <td style=\"text-align:right;\"> -0.4244494 </td>\n   <td style=\"text-align:right;\"> 0.4207048 </td>\n   <td style=\"text-align:right;\"> 0.7252970 </td>\n   <td style=\"text-align:right;\"> 1.3541270 </td>\n   <td style=\"text-align:right;\"> -0.2903392 </td>\n   <td style=\"text-align:right;\"> 0.2202908 </td>\n   <td style=\"text-align:right;\"> -0.6732108 </td>\n   <td style=\"text-align:right;\"> 0.6823849 </td>\n   <td style=\"text-align:right;\"> 0.2613426 </td>\n   <td style=\"text-align:right;\"> 0.6063306 </td>\n   <td style=\"text-align:right;\"> 0.1096274 </td>\n   <td style=\"text-align:right;\"> 0.6444267 </td>\n   <td style=\"text-align:right;\"> -0.1245026 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0.7335355 </td>\n   <td style=\"text-align:right;\"> 0.7597720 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> FIFTH THIRD BANK, NATIONAL ASSOCIATION (723112) </td>\n   <td style=\"text-align:right;\"> 0.9397406 </td>\n   <td style=\"text-align:right;\"> 0.4953873 </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 0.0e+00 </td>\n   <td style=\"text-align:right;\"> 0.1503070 </td>\n   <td style=\"text-align:right;\"> -0.3245710 </td>\n   <td style=\"text-align:right;\"> -0.3712957 </td>\n   <td style=\"text-align:right;\"> 0.3303831 </td>\n   <td style=\"text-align:right;\"> 0.8195856 </td>\n   <td style=\"text-align:right;\"> 1.8988475 </td>\n   <td style=\"text-align:right;\"> -0.0576689 </td>\n   <td style=\"text-align:right;\"> 0.3166796 </td>\n   <td style=\"text-align:right;\"> -0.4478027 </td>\n   <td style=\"text-align:right;\"> 0.5005818 </td>\n   <td style=\"text-align:right;\"> 0.4133066 </td>\n   <td style=\"text-align:right;\"> 0.7880407 </td>\n   <td style=\"text-align:right;\"> 0.0843445 </td>\n   <td style=\"text-align:right;\"> 0.6338198 </td>\n   <td style=\"text-align:right;\"> -0.1774798 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0.0439612 </td>\n   <td style=\"text-align:right;\"> 0.8577497 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> PNC BANK, NATIONAL ASSOCIATION (817824) </td>\n   <td style=\"text-align:right;\"> 0.9620229 </td>\n   <td style=\"text-align:right;\"> 0.4125401 </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1.0e-07 </td>\n   <td style=\"text-align:right;\"> -1.2555379 </td>\n   <td style=\"text-align:right;\"> 1.7181458 </td>\n   <td style=\"text-align:right;\"> -0.3850961 </td>\n   <td style=\"text-align:right;\"> 0.3024497 </td>\n   <td style=\"text-align:right;\"> 0.8190945 </td>\n   <td style=\"text-align:right;\"> 1.8843689 </td>\n   <td style=\"text-align:right;\"> -0.1386157 </td>\n   <td style=\"text-align:right;\"> 0.1700975 </td>\n   <td style=\"text-align:right;\"> -0.4646067 </td>\n   <td style=\"text-align:right;\"> 0.3128175 </td>\n   <td style=\"text-align:right;\"> 0.4776939 </td>\n   <td style=\"text-align:right;\"> 0.6877573 </td>\n   <td style=\"text-align:right;\"> 0.1491430 </td>\n   <td style=\"text-align:right;\"> 0.7270746 </td>\n   <td style=\"text-align:right;\"> 0.0053933 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0.0410301 </td>\n   <td style=\"text-align:right;\"> 0.8952028 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> JPMORGAN CHASE BANK, NATIONAL ASSOCIATION (852218) </td>\n   <td style=\"text-align:right;\"> 0.9931198 </td>\n   <td style=\"text-align:right;\"> 0.5848797 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 0.0e+00 </td>\n   <td style=\"text-align:right;\"> -1.7736810 </td>\n   <td style=\"text-align:right;\"> 1.2264916 </td>\n   <td style=\"text-align:right;\"> -0.0253989 </td>\n   <td style=\"text-align:right;\"> 0.1200085 </td>\n   <td style=\"text-align:right;\"> 0.7836282 </td>\n   <td style=\"text-align:right;\"> 1.5759721 </td>\n   <td style=\"text-align:right;\"> 0.3558453 </td>\n   <td style=\"text-align:right;\"> 0.3995382 </td>\n   <td style=\"text-align:right;\"> -0.4764664 </td>\n   <td style=\"text-align:right;\"> 1.5532369 </td>\n   <td style=\"text-align:right;\"> 0.4016991 </td>\n   <td style=\"text-align:right;\"> 0.6156062 </td>\n   <td style=\"text-align:right;\"> 0.3315089 </td>\n   <td style=\"text-align:right;\"> 0.7477104 </td>\n   <td style=\"text-align:right;\"> 0.0146948 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0.1043897 </td>\n   <td style=\"text-align:right;\"> 0.9061529 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> TRUIST BANK (852320) </td>\n   <td style=\"text-align:right;\"> 0.8160881 </td>\n   <td style=\"text-align:right;\"> 0.4647253 </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 1.2e-06 </td>\n   <td style=\"text-align:right;\"> -0.3023944 </td>\n   <td style=\"text-align:right;\"> 1.0472471 </td>\n   <td style=\"text-align:right;\"> -0.2401802 </td>\n   <td style=\"text-align:right;\"> 0.3726378 </td>\n   <td style=\"text-align:right;\"> 0.5729107 </td>\n   <td style=\"text-align:right;\"> 0.7205237 </td>\n   <td style=\"text-align:right;\"> -0.1997724 </td>\n   <td style=\"text-align:right;\"> 0.3784874 </td>\n   <td style=\"text-align:right;\"> -0.4626074 </td>\n   <td style=\"text-align:right;\"> 0.4554389 </td>\n   <td style=\"text-align:right;\"> 0.3801507 </td>\n   <td style=\"text-align:right;\"> 0.4367390 </td>\n   <td style=\"text-align:right;\"> 0.2804475 </td>\n   <td style=\"text-align:right;\"> 0.8875054 </td>\n   <td style=\"text-align:right;\"> 0.2193493 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 1.3354639 </td>\n   <td style=\"text-align:right;\"> 0.7518632 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> SYNCHRONY BANK (1216022) </td>\n   <td style=\"text-align:right;\"> 0.9583228 </td>\n   <td style=\"text-align:right;\"> 0.7281406 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 1.0e-07 </td>\n   <td style=\"text-align:right;\"> -1.1054361 </td>\n   <td style=\"text-align:right;\"> -0.9893516 </td>\n   <td style=\"text-align:right;\"> -0.1540860 </td>\n   <td style=\"text-align:right;\"> 0.3172374 </td>\n   <td style=\"text-align:right;\"> 0.8249678 </td>\n   <td style=\"text-align:right;\"> 2.0969348 </td>\n   <td style=\"text-align:right;\"> 0.0325933 </td>\n   <td style=\"text-align:right;\"> 1.0060952 </td>\n   <td style=\"text-align:right;\"> -0.2377782 </td>\n   <td style=\"text-align:right;\"> 1.0902467 </td>\n   <td style=\"text-align:right;\"> 0.6011826 </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 0.0031254 </td>\n   <td style=\"text-align:right;\"> 0.8305433 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> COMENITY BANK (1391778) </td>\n   <td style=\"text-align:right;\"> 0.8816106 </td>\n   <td style=\"text-align:right;\"> 0.6342893 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 1.4e-06 </td>\n   <td style=\"text-align:right;\"> 0.4669581 </td>\n   <td style=\"text-align:right;\"> 0.2347604 </td>\n   <td style=\"text-align:right;\"> -0.3385372 </td>\n   <td style=\"text-align:right;\"> 0.5029550 </td>\n   <td style=\"text-align:right;\"> 0.6409841 </td>\n   <td style=\"text-align:right;\"> 1.0457416 </td>\n   <td style=\"text-align:right;\"> -0.1282904 </td>\n   <td style=\"text-align:right;\"> 0.7741376 </td>\n   <td style=\"text-align:right;\"> -0.3380846 </td>\n   <td style=\"text-align:right;\"> 0.7732397 </td>\n   <td style=\"text-align:right;\"> 0.3646252 </td>\n   <td style=\"text-align:right;\"> 0.6092864 </td>\n   <td style=\"text-align:right;\"> 0.3383142 </td>\n   <td style=\"text-align:right;\"> 0.7917034 </td>\n   <td style=\"text-align:right;\"> -0.0486182 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0.0698764 </td>\n   <td style=\"text-align:right;\"> 0.7933888 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> AMERICAN EXPRESS NATIONAL BANK (1394676) </td>\n   <td style=\"text-align:right;\"> 0.9574797 </td>\n   <td style=\"text-align:right;\"> 0.4513552 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 0.0e+00 </td>\n   <td style=\"text-align:right;\"> -0.7157205 </td>\n   <td style=\"text-align:right;\"> -0.3624476 </td>\n   <td style=\"text-align:right;\"> -0.1401022 </td>\n   <td style=\"text-align:right;\"> 0.1804753 </td>\n   <td style=\"text-align:right;\"> 0.8106249 </td>\n   <td style=\"text-align:right;\"> 2.1605963 </td>\n   <td style=\"text-align:right;\"> -0.2111819 </td>\n   <td style=\"text-align:right;\"> 0.6507361 </td>\n   <td style=\"text-align:right;\"> -0.7065411 </td>\n   <td style=\"text-align:right;\"> 2.3831955 </td>\n   <td style=\"text-align:right;\"> 0.5208409 </td>\n   <td style=\"text-align:right;\"> 0.7366520 </td>\n   <td style=\"text-align:right;\"> 0.2060539 </td>\n   <td style=\"text-align:right;\"> 0.6817191 </td>\n   <td style=\"text-align:right;\"> 0.1006688 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0.0435440 </td>\n   <td style=\"text-align:right;\"> 0.8883321 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> GOLDMAN SACHS BANK USA (2182786) </td>\n   <td style=\"text-align:right;\"> 0.8100554 </td>\n   <td style=\"text-align:right;\"> 0.3836232 </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 4.5e-05 </td>\n   <td style=\"text-align:right;\"> 1.6844750 </td>\n   <td style=\"text-align:right;\"> 0.3056753 </td>\n   <td style=\"text-align:right;\"> -0.1351757 </td>\n   <td style=\"text-align:right;\"> 0.3304125 </td>\n   <td style=\"text-align:right;\"> 0.4391781 </td>\n   <td style=\"text-align:right;\"> 0.2129213 </td>\n   <td style=\"text-align:right;\"> -0.1006611 </td>\n   <td style=\"text-align:right;\"> 0.1427707 </td>\n   <td style=\"text-align:right;\"> -0.3676032 </td>\n   <td style=\"text-align:right;\"> 0.3050328 </td>\n   <td style=\"text-align:right;\"> 0.0928975 </td>\n   <td style=\"text-align:right;\"> 0.3823882 </td>\n   <td style=\"text-align:right;\"> 0.1529199 </td>\n   <td style=\"text-align:right;\"> 0.5775250 </td>\n   <td style=\"text-align:right;\"> -0.1288178 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 1.8292797 </td>\n   <td style=\"text-align:right;\"> 0.8360823 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> MERRICK BANK CORPORATION (2615190) </td>\n   <td style=\"text-align:right;\"> 0.9392376 </td>\n   <td style=\"text-align:right;\"> 0.7320180 </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 1.4e-06 </td>\n   <td style=\"text-align:right;\"> 0.8783693 </td>\n   <td style=\"text-align:right;\"> 2.3679490 </td>\n   <td style=\"text-align:right;\"> -0.1656862 </td>\n   <td style=\"text-align:right;\"> 0.2580664 </td>\n   <td style=\"text-align:right;\"> 0.6839141 </td>\n   <td style=\"text-align:right;\"> 1.1048573 </td>\n   <td style=\"text-align:right;\"> 0.0358807 </td>\n   <td style=\"text-align:right;\"> 0.9151714 </td>\n   <td style=\"text-align:right;\"> -0.2124229 </td>\n   <td style=\"text-align:right;\"> 1.1467925 </td>\n   <td style=\"text-align:right;\"> 0.1968534 </td>\n   <td style=\"text-align:right;\"> 0.6811896 </td>\n   <td style=\"text-align:right;\"> 0.3281978 </td>\n   <td style=\"text-align:right;\"> 0.6880192 </td>\n   <td style=\"text-align:right;\"> -0.0666993 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 0.1095390 </td>\n   <td style=\"text-align:right;\"> 0.9318009 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> BARCLAYS BANK DELAWARE (2980209) </td>\n   <td style=\"text-align:right;\"> 0.9865523 </td>\n   <td style=\"text-align:right;\"> 0.7549541 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 0.0e+00 </td>\n   <td style=\"text-align:right;\"> -1.6695392 </td>\n   <td style=\"text-align:right;\"> 1.0055828 </td>\n   <td style=\"text-align:right;\"> -0.4032055 </td>\n   <td style=\"text-align:right;\"> 0.2939884 </td>\n   <td style=\"text-align:right;\"> 0.8139912 </td>\n   <td style=\"text-align:right;\"> 1.5934136 </td>\n   <td style=\"text-align:right;\"> -0.0566242 </td>\n   <td style=\"text-align:right;\"> 0.4595601 </td>\n   <td style=\"text-align:right;\"> -0.4834771 </td>\n   <td style=\"text-align:right;\"> 0.8584368 </td>\n   <td style=\"text-align:right;\"> 0.4117395 </td>\n   <td style=\"text-align:right;\"> 0.7075373 </td>\n   <td style=\"text-align:right;\"> 0.2047218 </td>\n   <td style=\"text-align:right;\"> 0.7067719 </td>\n   <td style=\"text-align:right;\"> 0.0628060 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 0.0291871 </td>\n   <td style=\"text-align:right;\"> 0.9101669 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> UBS BANK USA (3212149) </td>\n   <td style=\"text-align:right;\"> 0.6586897 </td>\n   <td style=\"text-align:right;\"> 0.2841908 </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 7.0e-07 </td>\n   <td style=\"text-align:right;\"> -1.1051358 </td>\n   <td style=\"text-align:right;\"> -0.1772843 </td>\n   <td style=\"text-align:right;\"> -0.2989032 </td>\n   <td style=\"text-align:right;\"> 0.4405643 </td>\n   <td style=\"text-align:right;\"> 0.4193080 </td>\n   <td style=\"text-align:right;\"> 1.0663938 </td>\n   <td style=\"text-align:right;\"> -0.2138265 </td>\n   <td style=\"text-align:right;\"> 0.1539270 </td>\n   <td style=\"text-align:right;\"> -0.4406132 </td>\n   <td style=\"text-align:right;\"> 0.4246829 </td>\n   <td style=\"text-align:right;\"> 0.4680670 </td>\n   <td style=\"text-align:right;\"> 0.3548904 </td>\n   <td style=\"text-align:right;\"> 0.1751299 </td>\n   <td style=\"text-align:right;\"> 0.2674653 </td>\n   <td style=\"text-align:right;\"> 0.2936549 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 2.2977103 </td>\n   <td style=\"text-align:right;\"> 0.5760050 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> COMENITY CAPITAL BANK (3224580) </td>\n   <td style=\"text-align:right;\"> 0.8455767 </td>\n   <td style=\"text-align:right;\"> 0.4529891 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 4.0e-07 </td>\n   <td style=\"text-align:right;\"> 0.6817779 </td>\n   <td style=\"text-align:right;\"> 0.8840862 </td>\n   <td style=\"text-align:right;\"> -0.2783004 </td>\n   <td style=\"text-align:right;\"> 0.2798365 </td>\n   <td style=\"text-align:right;\"> 0.5775788 </td>\n   <td style=\"text-align:right;\"> 0.6562419 </td>\n   <td style=\"text-align:right;\"> -0.1149518 </td>\n   <td style=\"text-align:right;\"> 0.3189898 </td>\n   <td style=\"text-align:right;\"> -0.3660835 </td>\n   <td style=\"text-align:right;\"> 0.4525592 </td>\n   <td style=\"text-align:right;\"> 0.0070013 </td>\n   <td style=\"text-align:right;\"> 0.4310639 </td>\n   <td style=\"text-align:right;\"> 0.1398500 </td>\n   <td style=\"text-align:right;\"> 0.5529005 </td>\n   <td style=\"text-align:right;\"> -0.2198478 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0.0917465 </td>\n   <td style=\"text-align:right;\"> 1.0487294 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> ALLY BANK (3284070) </td>\n   <td style=\"text-align:right;\"> 0.9619158 </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> 6.3e-06 </td>\n   <td style=\"text-align:right;\"> 1.5792112 </td>\n   <td style=\"text-align:right;\"> -0.0264698 </td>\n   <td style=\"text-align:right;\"> -0.2575805 </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> 0.5468821 </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> -0.3898026 </td>\n   <td style=\"text-align:right;\"> 0.4497236 </td>\n   <td style=\"text-align:right;\"> -0.4323360 </td>\n   <td style=\"text-align:right;\"> 0.4533100 </td>\n   <td style=\"text-align:right;\"> -0.4216400 </td>\n   <td style=\"text-align:right;\"> 0.5192130 </td>\n   <td style=\"text-align:right;\"> 0.8542969 </td>\n   <td style=\"text-align:right;\"> 0.7954341 </td>\n   <td style=\"text-align:right;\"> -0.2251910 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0.0000000 </td>\n   <td style=\"text-align:right;\"> 0.0000000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> CITIZENS BANK, NATIONAL ASSOCIATION (3303298) </td>\n   <td style=\"text-align:right;\"> 0.9863223 </td>\n   <td style=\"text-align:right;\"> 0.6944761 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0.0e+00 </td>\n   <td style=\"text-align:right;\"> -1.0110766 </td>\n   <td style=\"text-align:right;\"> 0.8573623 </td>\n   <td style=\"text-align:right;\"> -0.0136781 </td>\n   <td style=\"text-align:right;\"> 0.3236960 </td>\n   <td style=\"text-align:right;\"> 0.7765163 </td>\n   <td style=\"text-align:right;\"> 1.2272797 </td>\n   <td style=\"text-align:right;\"> 0.3146914 </td>\n   <td style=\"text-align:right;\"> 0.6471725 </td>\n   <td style=\"text-align:right;\"> -0.1009901 </td>\n   <td style=\"text-align:right;\"> 1.3067748 </td>\n   <td style=\"text-align:right;\"> 0.3351630 </td>\n   <td style=\"text-align:right;\"> 0.6725128 </td>\n   <td style=\"text-align:right;\"> 0.4907022 </td>\n   <td style=\"text-align:right;\"> 0.6855895 </td>\n   <td style=\"text-align:right;\"> 0.0442419 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 0.1129418 </td>\n   <td style=\"text-align:right;\"> 0.8616942 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n::: \n\nFrom these plots we can see that there are a few banks that started their credit card businesses after 2010 Q2 (or started reporting our target measure). These series begin at 0 and sharply increase after the first or second quarter. This pattern is expected considering it takes 30+ days for credit cards to become delinquent. However, for modelling we may want to drop the first few quarters to remove the impact of this initial sharp increase and reflect the ongoing state.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nselected_feats = c(\"lumpiness\",\"stability\",\"seasonal\")\n\n#remove first 2 quarters (take from start of series)\ndf_alltypes <- overdue30to89 |> \n                tsibble::group_by_key() |> \n                filter(Value != 0) |>\n                slice(3:n()) |>\n                filter_index(regulation_cutoff ~ .) |>\n                fill_gaps()\n\nall_ftbanks <- df_alltypes |> \n                features(Value, feature_set(tags = selected_feats))\n\nfinal_df <- df_alltypes |> \n                filter(BankType %in% c(\"LargeBank\", \"LargeCreditCardBank\")) |>\n                mutate(value_diff = difference(Value))\n```\n:::\n\n## Exploration of Statistical Features {#sec-feature-explore}\n\n@fig-quantile plots the distribution of Credit Card Plans-30-89 DAYS P/D %. We can see that there are two peaks for *Large Credit Card Banks*. There are 7 banks in the this peer group which may be too small to capture the true distribution effectively. However, it may also indicate that there are sub-groups within this peer group. For instance, the first peak could represent banks that have lower risk profiles, while the second represents banks that have a higher risk profiles.\n\n::: {#tbl-quantile .panel-tabset}\n\n## Distribution\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(final_df, aes(x=Value, colour = BankType))+ \n    geom_density(alpha = .3) +\n    labs(x=target_label) +\n    theme(legend.position=\"top\",legend.title=element_blank()) +\n    scale_color_manual(values = bank_type.colours())\n```\n\n::: {.cell-output-display}\n![Density plot](data_ffiec_files/figure-html/fig-quantile-1.png){#fig-quantile width=672}\n:::\n:::\n\n\n## Quantiles - Large Credit Card Banks\n\n::: {.cell}\n\n```{.r .cell-code}\nfinal_df |> na.omit() |>\n    filter(BankType == \"LargeCreditCardBank\") |>\n      features(Value, quantile)|> \n        select(-c(IDRSSD,Measure,Label,Description,BankType)) |>\n        arrange(`100%`)|> \n        knitr::kable(format = \"html\")        \n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> BankName </th>\n   <th style=\"text-align:right;\"> 0% </th>\n   <th style=\"text-align:right;\"> 25% </th>\n   <th style=\"text-align:right;\"> 50% </th>\n   <th style=\"text-align:right;\"> 75% </th>\n   <th style=\"text-align:right;\"> 100% </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> AMERICAN EXPRESS NATIONAL BANK (1394676) </td>\n   <td style=\"text-align:right;\"> 0.25 </td>\n   <td style=\"text-align:right;\"> 0.5625 </td>\n   <td style=\"text-align:right;\"> 0.650 </td>\n   <td style=\"text-align:right;\"> 0.7100 </td>\n   <td style=\"text-align:right;\"> 0.82 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> DISCOVER BANK (30810) </td>\n   <td style=\"text-align:right;\"> 0.61 </td>\n   <td style=\"text-align:right;\"> 0.7775 </td>\n   <td style=\"text-align:right;\"> 0.895 </td>\n   <td style=\"text-align:right;\"> 1.0800 </td>\n   <td style=\"text-align:right;\"> 1.79 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> BARCLAYS BANK DELAWARE (2980209) </td>\n   <td style=\"text-align:right;\"> 0.66 </td>\n   <td style=\"text-align:right;\"> 1.0600 </td>\n   <td style=\"text-align:right;\"> 1.135 </td>\n   <td style=\"text-align:right;\"> 1.2500 </td>\n   <td style=\"text-align:right;\"> 2.40 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> SYNCHRONY BANK (1216022) </td>\n   <td style=\"text-align:right;\"> 1.15 </td>\n   <td style=\"text-align:right;\"> 2.0025 </td>\n   <td style=\"text-align:right;\"> 2.225 </td>\n   <td style=\"text-align:right;\"> 2.3900 </td>\n   <td style=\"text-align:right;\"> 2.76 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> COMENITY BANK (1391778) </td>\n   <td style=\"text-align:right;\"> 2.35 </td>\n   <td style=\"text-align:right;\"> 2.7325 </td>\n   <td style=\"text-align:right;\"> 3.040 </td>\n   <td style=\"text-align:right;\"> 3.4100 </td>\n   <td style=\"text-align:right;\"> 3.90 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> COMENITY CAPITAL BANK (3224580) </td>\n   <td style=\"text-align:right;\"> 2.13 </td>\n   <td style=\"text-align:right;\"> 2.6150 </td>\n   <td style=\"text-align:right;\"> 2.725 </td>\n   <td style=\"text-align:right;\"> 2.9950 </td>\n   <td style=\"text-align:right;\"> 3.91 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> MERRICK BANK CORPORATION (2615190) </td>\n   <td style=\"text-align:right;\"> 1.86 </td>\n   <td style=\"text-align:right;\"> 2.9350 </td>\n   <td style=\"text-align:right;\"> 3.340 </td>\n   <td style=\"text-align:right;\"> 3.7475 </td>\n   <td style=\"text-align:right;\"> 5.44 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n## Quantiles - Large Banks\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfinal_df |> na.omit() |>\n    filter(BankType == \"LargeBank\") |>\n      features(Value, quantile)|> \n        select(-c(IDRSSD,Measure,Label,Description,BankType)) |> \n        arrange(`100%`)|> \n        knitr::kable(format = \"html\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> BankName </th>\n   <th style=\"text-align:right;\"> 0% </th>\n   <th style=\"text-align:right;\"> 25% </th>\n   <th style=\"text-align:right;\"> 50% </th>\n   <th style=\"text-align:right;\"> 75% </th>\n   <th style=\"text-align:right;\"> 100% </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> BANK OF AMERICA, NATIONAL ASSOCIATION (480228) </td>\n   <td style=\"text-align:right;\"> 0.59 </td>\n   <td style=\"text-align:right;\"> 0.7700 </td>\n   <td style=\"text-align:right;\"> 0.880 </td>\n   <td style=\"text-align:right;\"> 0.9650 </td>\n   <td style=\"text-align:right;\"> 1.03 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> UBS BANK USA (3212149) </td>\n   <td style=\"text-align:right;\"> 0.26 </td>\n   <td style=\"text-align:right;\"> 0.4650 </td>\n   <td style=\"text-align:right;\"> 0.540 </td>\n   <td style=\"text-align:right;\"> 0.7100 </td>\n   <td style=\"text-align:right;\"> 1.05 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> MANUFACTURERS AND TRADERS TRUST COMPANY (501105) </td>\n   <td style=\"text-align:right;\"> 0.69 </td>\n   <td style=\"text-align:right;\"> 1.0050 </td>\n   <td style=\"text-align:right;\"> 1.130 </td>\n   <td style=\"text-align:right;\"> 1.2100 </td>\n   <td style=\"text-align:right;\"> 1.58 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> REGIONS BANK (233031) </td>\n   <td style=\"text-align:right;\"> 0.97 </td>\n   <td style=\"text-align:right;\"> 1.1300 </td>\n   <td style=\"text-align:right;\"> 1.280 </td>\n   <td style=\"text-align:right;\"> 1.3675 </td>\n   <td style=\"text-align:right;\"> 1.65 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> HUNTINGTON NATIONAL BANK, THE (12311) </td>\n   <td style=\"text-align:right;\"> 0.54 </td>\n   <td style=\"text-align:right;\"> 0.7000 </td>\n   <td style=\"text-align:right;\"> 0.940 </td>\n   <td style=\"text-align:right;\"> 1.2875 </td>\n   <td style=\"text-align:right;\"> 1.69 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> FIRST-CITIZENS BANK &amp; TRUST COMPANY (491224) </td>\n   <td style=\"text-align:right;\"> 0.74 </td>\n   <td style=\"text-align:right;\"> 0.8400 </td>\n   <td style=\"text-align:right;\"> 0.965 </td>\n   <td style=\"text-align:right;\"> 1.1125 </td>\n   <td style=\"text-align:right;\"> 1.72 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> FIFTH THIRD BANK, NATIONAL ASSOCIATION (723112) </td>\n   <td style=\"text-align:right;\"> 0.84 </td>\n   <td style=\"text-align:right;\"> 1.0000 </td>\n   <td style=\"text-align:right;\"> 1.140 </td>\n   <td style=\"text-align:right;\"> 1.3825 </td>\n   <td style=\"text-align:right;\"> 1.80 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> U.S. BANK NATIONAL ASSOCIATION (504713) </td>\n   <td style=\"text-align:right;\"> 0.72 </td>\n   <td style=\"text-align:right;\"> 1.1150 </td>\n   <td style=\"text-align:right;\"> 1.235 </td>\n   <td style=\"text-align:right;\"> 1.3125 </td>\n   <td style=\"text-align:right;\"> 1.85 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> CITIZENS BANK, NATIONAL ASSOCIATION (3303298) </td>\n   <td style=\"text-align:right;\"> 0.93 </td>\n   <td style=\"text-align:right;\"> 1.1000 </td>\n   <td style=\"text-align:right;\"> 1.185 </td>\n   <td style=\"text-align:right;\"> 1.2725 </td>\n   <td style=\"text-align:right;\"> 2.09 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> JPMORGAN CHASE BANK, NATIONAL ASSOCIATION (852218) </td>\n   <td style=\"text-align:right;\"> 0.47 </td>\n   <td style=\"text-align:right;\"> 0.7475 </td>\n   <td style=\"text-align:right;\"> 0.870 </td>\n   <td style=\"text-align:right;\"> 0.9925 </td>\n   <td style=\"text-align:right;\"> 2.14 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> TD BANK, N.A. (497404) </td>\n   <td style=\"text-align:right;\"> 0.79 </td>\n   <td style=\"text-align:right;\"> 1.2175 </td>\n   <td style=\"text-align:right;\"> 1.400 </td>\n   <td style=\"text-align:right;\"> 1.5175 </td>\n   <td style=\"text-align:right;\"> 2.16 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> GOLDMAN SACHS BANK USA (2182786) </td>\n   <td style=\"text-align:right;\"> 0.82 </td>\n   <td style=\"text-align:right;\"> 1.0150 </td>\n   <td style=\"text-align:right;\"> 1.195 </td>\n   <td style=\"text-align:right;\"> 1.7000 </td>\n   <td style=\"text-align:right;\"> 2.19 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> KEYBANK NATIONAL ASSOCIATION (280110) </td>\n   <td style=\"text-align:right;\"> 0.54 </td>\n   <td style=\"text-align:right;\"> 0.8550 </td>\n   <td style=\"text-align:right;\"> 1.040 </td>\n   <td style=\"text-align:right;\"> 1.2000 </td>\n   <td style=\"text-align:right;\"> 2.26 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> TRUIST BANK (852320) </td>\n   <td style=\"text-align:right;\"> 0.73 </td>\n   <td style=\"text-align:right;\"> 0.8300 </td>\n   <td style=\"text-align:right;\"> 0.910 </td>\n   <td style=\"text-align:right;\"> 1.1100 </td>\n   <td style=\"text-align:right;\"> 2.34 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> PNC BANK, NATIONAL ASSOCIATION (817824) </td>\n   <td style=\"text-align:right;\"> 0.89 </td>\n   <td style=\"text-align:right;\"> 1.0775 </td>\n   <td style=\"text-align:right;\"> 1.235 </td>\n   <td style=\"text-align:right;\"> 1.3600 </td>\n   <td style=\"text-align:right;\"> 2.42 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> HSBC BANK USA, NATIONAL ASSOCIATION (413208) </td>\n   <td style=\"text-align:right;\"> 0.88 </td>\n   <td style=\"text-align:right;\"> 1.3100 </td>\n   <td style=\"text-align:right;\"> 1.480 </td>\n   <td style=\"text-align:right;\"> 1.7225 </td>\n   <td style=\"text-align:right;\"> 2.44 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> CAPITAL ONE, NATIONAL ASSOCIATION (112837) </td>\n   <td style=\"text-align:right;\"> 1.16 </td>\n   <td style=\"text-align:right;\"> 1.5900 </td>\n   <td style=\"text-align:right;\"> 1.800 </td>\n   <td style=\"text-align:right;\"> 2.0100 </td>\n   <td style=\"text-align:right;\"> 2.62 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> WELLS FARGO BANK, NATIONAL ASSOCIATION (451965) </td>\n   <td style=\"text-align:right;\"> 0.69 </td>\n   <td style=\"text-align:right;\"> 1.1000 </td>\n   <td style=\"text-align:right;\"> 1.230 </td>\n   <td style=\"text-align:right;\"> 1.3050 </td>\n   <td style=\"text-align:right;\"> 2.67 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> SANTANDER BANK, NATIONAL ASSOCIATION (722777) </td>\n   <td style=\"text-align:right;\"> 0.71 </td>\n   <td style=\"text-align:right;\"> 0.9800 </td>\n   <td style=\"text-align:right;\"> 1.340 </td>\n   <td style=\"text-align:right;\"> 1.4800 </td>\n   <td style=\"text-align:right;\"> 2.67 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> ALLY BANK (3284070) </td>\n   <td style=\"text-align:right;\"> 2.10 </td>\n   <td style=\"text-align:right;\"> 2.3100 </td>\n   <td style=\"text-align:right;\"> 2.380 </td>\n   <td style=\"text-align:right;\"> 2.4825 </td>\n   <td style=\"text-align:right;\"> 2.79 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> CITIBANK, N.A. (476810) </td>\n   <td style=\"text-align:right;\"> 0.67 </td>\n   <td style=\"text-align:right;\"> 1.0750 </td>\n   <td style=\"text-align:right;\"> 1.180 </td>\n   <td style=\"text-align:right;\"> 1.3775 </td>\n   <td style=\"text-align:right;\"> 3.18 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> BMO HARRIS BANK NATIONAL ASSOCIATION (75633) </td>\n   <td style=\"text-align:right;\"> 0.73 </td>\n   <td style=\"text-align:right;\"> 1.1900 </td>\n   <td style=\"text-align:right;\"> 1.300 </td>\n   <td style=\"text-align:right;\"> 1.5300 </td>\n   <td style=\"text-align:right;\"> 5.06 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n::: \n\n@fig-lfeature shows the features from @sec-outliers that we can use to further explore the characteristics of each peer group (the calculations are documented in the tsfeatures R package by @tsfeatures). \n\nThe *Other Banks* peer group has been added for interest. \n\n\n::: {#fig-lfeature .cell layout-ncol=\"2\"}\n\n```{.r .cell-code}\nfeatures.plot_violin(all_ftbanks, \"var_tiled_var\")\n\nfeatures.plot_violin(all_ftbanks, \"var_tiled_mean\")\n\nfeatures.plot_violin(all_ftbanks, \"seasonal_strength_year\")\n\nfeatures.plot_violin(all_ftbanks, \"trend_strength\")\n\nfeatures.plot_violin(all_ftbanks, \"linearity\")\n\nfeatures.plot_violin(all_ftbanks, \"stl_e_acf1\")\n\nfeatures.plot_violin(all_ftbanks, \"stl_e_acf10\")\n\nfeatures.plot_violin(all_ftbanks, \"nsdiffs\")\n```\n\n::: {.cell-output-display}\n![Lumpiness - variance of the variances based on tiled yearly(non-overlapping) windows](data_ffiec_files/figure-html/fig-lfeature-1.png){#fig-lfeature-1 width=672}\n:::\n\n::: {.cell-output-display}\n![Stability - the variance of the means based on tiled yearly(non-overlapping) windows](data_ffiec_files/figure-html/fig-lfeature-2.png){#fig-lfeature-2 width=672}\n:::\n\n::: {.cell-output-display}\n![STL decomposition Seasonal Strength - 0 is week (non-seasonal), 1 is strong](data_ffiec_files/figure-html/fig-lfeature-3.png){#fig-lfeature-3 width=672}\n:::\n\n::: {.cell-output-display}\n![STL decomposition Trend Strength - 0 is week (no trend), 1 is strong](data_ffiec_files/figure-html/fig-lfeature-4.png){#fig-lfeature-4 width=672}\n:::\n\n::: {.cell-output-display}\n![Linearity -  values around 0 indicate the series is linear](data_ffiec_files/figure-html/fig-lfeature-5.png){#fig-lfeature-5 width=672}\n:::\n\n::: {.cell-output-display}\n![Autocorrelation - first autocorrelation coefficient](data_ffiec_files/figure-html/fig-lfeature-6.png){#fig-lfeature-6 width=672}\n:::\n\n::: {.cell-output-display}\n![Autocorrelation - 10th autocorrelation coefficient. In a completely random series (white noise), we would expect autocorrelation coefficients near zero for all lags](data_ffiec_files/figure-html/fig-lfeature-7.png){#fig-lfeature-7 width=672}\n:::\n\n::: {.cell-output-display}\n![Minimum number of differences necessary to obtain a stationary time series](data_ffiec_files/figure-html/fig-lfeature-8.png){#fig-lfeature-8 width=672}\n:::\n\nExploring Statistical Features (Post Regulatory environment)\n:::\n\n\n1. @fig-lfeature-1: *Other Banks* are lumpy. Also we can see from @fig-regulation-2 that lumpiness continued post regulatory changes even though *Other Banks* are subject to the same regulation. \n2. @fig-lfeature-2: For *Large Banks* and *Large Credit Card Banks* the stability is ~0.8 indicating a degree of fluctuation in the data from one year to the next.\n3. @fig-lfeature-3 *Large Credit Card* Banks are seasonal. This can also be seen in the undulating shape in ACF plot (see @fig-acf-1). \n\n    @fig-season shows both *Large Banks* and *Large Credit Card Banks* peak in Q3. Given events like Black Friday, Thanksgiving and Christmas occur in Q4, we may have expected peak delinquency in Q4 or Q1. \n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf_alltypes |> group_by(BankType) |> \n    summarise(mean = mean(Value, na.rm=T)) |> \n        gg_subseries() +\n        labs(y=glue(\"{target_label} \\n mean\"))\n```\n\n::: {.cell-output-display}\n![Quarterly Seasonal Subseries. The blue horizontal lines indicate the means for each quarter.](data_ffiec_files/figure-html/fig-season-1.png){#fig-season width=672}\n:::\n:::\n\n\n\n\n4. @fig-lfeature-4 and @fig-lfeature-5 indicates a strong linear trend for *Large Banks* and *Large Credit Card Banks*.\n5. @fig-lfeature-6 the first autocorrelation coefficient is close to 0 which indicates a weak linear relationship between lagged values. Of note the coefficients are negative indicating a tendency for a short-term reversal. This can be seen in @fig-regulation-1 where the values oscillate.\n6. @fig-lfeature-7 the 10th autocorrelation coefficient. Checking overall autocorrelation using the Ljung-Box test proves autocorrelation i.e. data pattern is not due to chance.\n\n**Ljung-Box test**\n\n::: {.border}\n\n::: {.cell}\n\n```{.r .cell-code}\nfinal_df |> na.omit() |> pull(value_diff) |> Box.test(lag = 10, type = \"Ljung\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tBox-Ljung test\n\ndata:  pull(na.omit(final_df), value_diff)\nX-squared = 380.41, df = 10, p-value < 2.2e-16\n```\n:::\n:::\n\n:::\n\n\n7. @fig-lfeature-8 *Large Credit Card Banks* is not stationary i.e. the statistical properties of the time series changes, which makes it difficult to identify trends and patterns. Performing a difference i.e. to get the quarterly change in UBPRE524, makes the series stationary as shown in @fig-acf-2. This can be confirmed by performing an augmented DickeyFuller (ADF) test on the differenced value. We also see that, post differencing, there are autocorrelation coefficients above the significance threshold. This is likely due to seasonality as these are at regular intervals. The decreasing magnitude of these coefficients tell us the earlier lags have a stronger influence than values further in the past.\n\n    Autocorrelation, the correlation between the timeseries and its own lagged values, can inform a moving average (MA) Model. If we additionally look at the partial autocorrelation, the correlation after removing the effect of any correlations due to the terms at shorter lags (see @fig-acf-3 and @fig-acf-4)\n    \n    @fig-acf for *Large Credit Card Banks* we see a Seasonal-ARMA process as both ACF and PACF are declining gradually around every 4th lag. This confirms what we saw in @fig-lfeature-3.\n\n\n::: {#fig-acf .cell layout-ncol=\"2\"}\n\n```{.r .cell-code}\nagg_df <- final_df |> \n            group_by(BankType)|> \n            summarise(mean_val = mean(Value, na.rm=T),\n                      mean_diff = mean(value_diff, na.rm=T)) \n       \nagg_df |> ACF(x=mean_val,lag_max = 42) |> autoplot()\nagg_df |> ACF(x=mean_diff,lag_max = 42) |> autoplot()\n\nagg_df |> PACF(x=mean_val,lag_max = 42) |> autoplot()\nagg_df |> PACF(x=mean_diff,lag_max = 42) |> autoplot()\n```\n\n::: {.cell-output-display}\n![ACF on original value](data_ffiec_files/figure-html/fig-acf-1.png){#fig-acf-1 width=672}\n:::\n\n::: {.cell-output-display}\n![ACF on first difference value](data_ffiec_files/figure-html/fig-acf-2.png){#fig-acf-2 width=672}\n:::\n\n::: {.cell-output-display}\n![PACF on original value](data_ffiec_files/figure-html/fig-acf-3.png){#fig-acf-3 width=672}\n:::\n\n::: {.cell-output-display}\n![PACF on first difference value](data_ffiec_files/figure-html/fig-acf-4.png){#fig-acf-4 width=672}\n:::\n\nACF and PACF\n:::\n\n**DickeyFuller (ADF) test**\n\n::: {.border}\n\n::: {.cell}\n\n```{.r .cell-code}\nfinal_df |> na.omit() |> pull(value_diff) |> tseries::adf.test()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tAugmented Dickey-Fuller Test\n\ndata:  pull(na.omit(final_df), value_diff)\nDickey-Fuller = -12.892, Lag order = 11, p-value = 0.01\nalternative hypothesis: stationary\n```\n:::\n:::\n\n:::\n\n## Summary\n\nIn summary, based on exploration of the data we will prepare the data for modelling by:\n\n***Selecting:***\n\n1. Target measure: *Credit Card Plans-30-89 DAYS P/D %* (UBPRE524).\n2. Banks: *Large Banks* and *Large Credit Card* Banks.\n3. Date Period: from 2010 Q2.\n\n***Removing:***\n\n4. Outlier data points: first 2 quarters.\n\n***Transforming:***\n\n5. the Target measure to make it stationary. We do this by taking the first difference. \n\n## References",
    "supporting": [
      "data_ffiec_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}