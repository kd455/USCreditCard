{
  "hash": "d18cae63ea287675c98b7a22be0d68de",
  "result": {
    "markdown": "## Simulation Example {#simulate}\n\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\noverdue30to89 <- us_credit_card.30to89_overdue()\n\noverdue30to89 |>\n  filter(BankName == \"1ST CAPITAL BANK (3594797)\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tsibble: 1 x 6 [1D]\n# Key:       BankName [1]\n  BankName         Value Quarter    LargeBank CreditCardBank LargeCreditCardBank\n  <chr>            <dbl> <date>         <int>          <int>               <int>\n1 1ST CAPITAL BANâ€¦     0 2008-09-30         0              0                   0\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nzero_data_firms <- overdue30to89 |>\n                      features(Value,features = list(mean = mean, sd = sd, var = var, var_tiled_var)) |>\n                        filter(sd == 0 | is.na(sd))       \n\noverdue30to89 |>\n  filter(!BankName %in% zero_data_firms) |>\n  summarise(y.mean = mean(Value),\n            y.var = var(Value)) |> \n  pivot_longer(cols = -Quarter, names_to = \"name\") |>\n  autoplot() + facet_wrap(~ name, scales = \"free_y\" , ncol = 1)\n```\n\n::: {.cell-output-display}\n![](simulation_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\noverdue30to89_agg <- overdue30to89 |>\n                      filter(!BankName %in% zero_data_firms) |>\n                      summarise(y = mean(Value)) |>\n                        mutate(y.log = log(y), \n                               y.log.diff = y.log - lag(y.log),\n                               y.log.diff.lag1 = lag(y.log.diff,1),\n                               y.log.diff.lag2 = lag(y.log.diff,2))\n\noverdue30to89_agg |>\n  pivot_longer(cols = -Quarter, names_to = \"name\") |>\n  autoplot() + facet_wrap(~ name, scales = \"free_y\" , ncol = 1)\n```\n\n::: {.cell-output-display}\n![](simulation_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nm.ar1 = lm(y.log.diff ~ y.log.diff.lag1, data = na.omit(overdue30to89_agg))\nm.ar2 = lm(y.log.diff ~ y.log.diff.lag1 + y.log.diff.lag2, data = na.omit(overdue30to89_agg))\n\nsummary(m.ar1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = y.log.diff ~ y.log.diff.lag1, data = na.omit(overdue30to89_agg))\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-0.51792 -0.04412  0.02022  0.06693  0.24695 \n\nCoefficients:\n                Estimate Std. Error t value Pr(>|t|)  \n(Intercept)     -0.00686    0.01373  -0.500    0.619  \ny.log.diff.lag1 -0.26609    0.10910  -2.439    0.017 *\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.1226 on 78 degrees of freedom\nMultiple R-squared:  0.07086,\tAdjusted R-squared:  0.05895 \nF-statistic: 5.949 on 1 and 78 DF,  p-value: 0.017\n```\n:::\n\n```{.r .cell-code}\nsummary(m.ar2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = y.log.diff ~ y.log.diff.lag1 + y.log.diff.lag2, \n    data = na.omit(overdue30to89_agg))\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-0.54639 -0.04137  0.01824  0.05610  0.26594 \n\nCoefficients:\n                Estimate Std. Error t value Pr(>|t|)    \n(Intercept)     -0.01002    0.01278  -0.784 0.435560    \ny.log.diff.lag1 -0.36654    0.10503  -3.490 0.000803 ***\ny.log.diff.lag2 -0.38399    0.10511  -3.653 0.000470 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.1139 on 77 degrees of freedom\nMultiple R-squared:  0.2081,\tAdjusted R-squared:  0.1875 \nF-statistic: 10.12 on 2 and 77 DF,  p-value: 0.0001254\n```\n:::\n:::\n",
    "supporting": [
      "simulation_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}